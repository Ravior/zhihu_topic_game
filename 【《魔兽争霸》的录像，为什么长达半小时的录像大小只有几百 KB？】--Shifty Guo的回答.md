## 《魔兽争霸》的录像，为什么长达半小时的录像大小只有几百 KB？

作者: [Shifty Guo](http://www.zhihu.com/people/shifty-guo)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 赞同: 424


没想到这么多赞，当初这样答完全是因为看到大家都已经讲了rep的本质，于是就补充一下当初自己是怎么理解录像中的随机种子的。<br>再改一下吧，手机打字比较辛苦，链接也不好弄，望见谅。<br>首先正面回答答主的问题，为什么rep会小？其他的答主也都给出了答案，在这里尤为推荐杨浩的答案<br><a href="http://www.zhihu.com/question/25431134/answer/30917935" class="internal"><span class="invisible">http://www.</span><span class="visible">zhihu.com/question/2543</span><span class="invisible">1134/answer/30917935</span><span class="ellipsis"></span></a><br>在该答案中他给出了rep的描述文档，如果大家可以看懂那个的话可以直接跳过我的简单举例子答案。<br>下面我同样是以举例子的角度正面回答题主的问题。rep文件不是传统意义上的录像，话剧中的“剧本”这个实际生活中的概念和它更接近。每当玩家们看录像时，游戏内的模型、数值、算法等资源就被调动，相当于话剧演员穿戴服装道具在舞台上重新演了一遍。相对于把整部话剧拍下来的视频文件大小而言，话剧的剧本的文本量则必然会小得多。而至于有的朋友提问为什么rep在播放时会出错，与原先的实际情况不一致？大家可以这样理解，剧本在印制或派发时出现了缺页或污损，演员们看不懂不会演了。在游戏中类似道理的应用就是用即时演算替代cg。<br><br>下面是原答案，只说了随机种子部分。<br>=================================<br>补充一下，在理解rep只是存储操作指令和单位状态后，我小时候还一直不清楚几率相关的东西是怎么存进rep的，比如攻击力在魔兽中是个范围而不像在星际中是个确定数值，剑圣/dh这刀是否暴击/被闪避，坡下打坡上是不是miss，直到我接触了伪随机数。直到现在和别人解释伪随机数时我都用星际魔兽rep里的暴击作为材料。<br><br>粘贴评论中的举例：<br><br>为简化，假设剑圣暴击率是10%，2倍暴击，而平砍伤害是10-20，剑圣砍了一刀，实际伤害30（15*2），第二刀坡下砍坡上，miss了。如果在rep中直接储存暴击30，第二刀miss也是可以的，但是这样显然要把剑圣一局游戏中的每一刀都要存下来，较为占用空间。而rep中采用的做法是，魔兽游戏中生成了一个伪随机数序列，这个序列在游戏中，不在rep里，但是rep播放时可以调用。例如取0-1的均匀分布，比如0.753、0.500、0.988、0.132、0.781、0.646………均匀分布即为在0-1中取到这些数中的每一个概率是一致的），然后在rep中记录随机数种子（随机数开始的序列位置）。例如本rep种子为1，即从0.753开始。剑圣第一刀坡下砍坡上，命中率70%，可以等价于伪随机数值大于0.3即命中，而0.753大于0.3，故命中。下面实际攻击取10+(20-10)*随机数，此处为0.5，故攻击为15。下面计算暴击，和命中类似，随机数大于0.9即为暴击，此处为0.988，满足，故最终伤害为30。第二刀由于0.132小于0.3，故miss。作为rep，只需要存储剑圣的坐标、命令和种子数1，就能再现这两刀。此外其他游戏里的掉宝率也是这样的，例如暗黑。那个哥布林在你决定杀他的一刹那，他掉什么已经确定了，所以叫伪随机。<br>ps:我们打wow时说组了个黑手，这个CD就被他黑了，是有道理的。<br><br>关于更真实更复杂的实际情况，牵扯到概率的补偿，不会永远让你感到黑手没法玩（例如最近wow中好运币roll装备若没roll到则几率越来越高）。请参考评论中zy RSN的说明。<br><br>对于近战坡下砍坡上不会miss的问题，我搞错了，答题时也忽略了这个事实。那大家把例子想成DOTA里带水晶剑的远程英雄（不带金箍棒克敌机先）吧。<br><br>虽说有点走题，不过关于魔兽世界中的掉落问题，确实如评论中所说，是在第一个人进入副本时根据掉落表生成的。不过我想表达的意思没有变，随机的事物实际上往往是不那么随机的。至于掉落表怎么做，实际掉落生成方式怎么设计，这个水很深，超出了我认知范围，还是请专业的数值人员来回答吧。



编辑于 2014-09-24



---
原问链接: [http://www.zhihu.com/question/25431134](http://www.zhihu.com/question/25431134)