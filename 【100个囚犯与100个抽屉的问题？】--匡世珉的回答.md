## 100个囚犯与100个抽屉的问题？

作者: [匡世珉](http://www.zhihu.com/people/kuang-shi-min)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 赞同: 667


<p><b>先上结论：犯人们被释放的概率可以超过30%。</b></p><br><p>如果你没有意识到这个结论有多么<b>惊人</b>的话，我们先来做一个计算：</p><br><p>如果每个人<b>随机</b>选择，那么他找到自己号码的概率是50%；所以，所有人都找到自己号码的概率将是1/2的100次方。这个值约等于：</p><br><p><b>0.0000000000000000000000000000008</b></p><br><p>而采取一定的策略，我们可以使释放的概率<b>超过0.3</b>！【停顿两秒，此处应有掌声】</p><br><p>首先我们把这一行抽屉按顺序从1到100依次编上号。</p><br><p>策略如下：</p><br><p><b>1.</b><b>每个人首先打开与自己的编号一样的抽屉。</b>例如：1号犯人进房间之后首先打开1号抽屉。</p><br><p><b>2.</b><b>如果抽屉里就是他的编号，那么潇洒离场。</b>例如：1号犯人发现1号抽屉里就是1号卡片，潇洒离场。</p><br><p><b>3.</b><b>否则，他接下来打开与该抽屉里的号码一样的抽屉。</b>例如：1号犯人发现1号抽屉里放着72号卡片，那么他接下来打开72号抽屉。</p><br><p><b>4.重复第二、第三步，直到找到自己的号码后潇洒离场，或者打开50个抽屉也没找到后黯然神伤。</b></p><br><p>就是这么简单。</p><br><p>方便起见，我们用“总共8个抽屉、每人4次尝试”作为例子：</p><br><p>假设排列如下：</p><img src="http://pic2.zhimg.com/67d02866f072e78b72ae9e045667b011_b.jpg" data-rawwidth="385" data-rawheight="70" class="content_image" width="385"><br><p>于是：</p><br><p>1号犯人首先打开1号抽屉，发现里边放着7号卡片；接着打开7号抽屉，发现里边放着5号卡片；接着打开5号抽屉，发现里边放着1号卡片，潇洒离场。</p><br><p>2号犯人首先打开2号抽屉，接着依次打开4号、8号抽屉，然后潇洒离场。</p><br><p>3号犯人依次打开3号、6号抽屉，然后潇洒离场。</p><br><p>4号犯人依次打开4号、8号、2号抽屉，然后潇洒离场。</p><br><p>5~8号犯人同理。</p><br><p>所有犯人都被释放啦！</p><br><p>但并非每次都这么走运，假设排列如下：</p><img src="http://pic1.zhimg.com/7985fdf7af6c0cbb9bf7729f59d25888_b.jpg" data-rawwidth="385" data-rawheight="71" class="content_image" width="385"><br><p>1号犯人依次打开1号、3号、7号、4号……心灰意冷，黯然神伤。</p><br><p>2号犯人依次打开2号、1号、3号、7号……心灰意冷，黯然神伤。</p><br><p>最后，除了6号犯人潇洒离场以外，所有犯人都黯然神伤。</p><br><p>时而成功，时而失败，到底什么是影响成败的因素呢？不急不急，让我慢慢说。</p><br><p>事实上，我们可以用“<b>置换群</b>”来表示卡片的摆放。</p><br><p>让我们先来看那个成功的例子：</p><br><p>1号抽屉放着7号卡片，7号抽屉放着5号卡片，5号抽屉放着1号卡片；</p><br><p>2号抽屉放着4号卡片，4号抽屉放着8号卡片，8号抽屉放着2号卡片；</p><br><p>3号抽屉放着6号卡片，6号抽屉放着3号卡片。</p><br><p>发现了吗？这个排列形成了3个“<b>环</b>”。</p><br><p>这个摆放可以用循环置换记法记为<b>(1 7 5)(2 4 8)(3 6)</b>。如下图：</p><img src="http://pic1.zhimg.com/6710b765228f4d73dedbc61ab3755d34_b.jpg" data-rawwidth="110" data-rawheight="110" class="content_image" width="110"><br><p>同理，那个失败例子的摆放可以记为<b>(1 3 7 4 5 8 2)(6)</b>。如下图：</p><img src="http://pic3.zhimg.com/17b2423e2ec3cd11d38f9d9157197456_b.jpg" data-rawwidth="110" data-rawheight="110" class="content_image" width="110"><br><p>不管卡片怎么摆放，我们都可以表示成“环”的形式，因为每个抽屉只能从一个卡片指来，而这个抽屉里的卡片又只能指向一个抽屉，且抽屉的个数是有限的。</p><br><p>其中最小的“环”的长度就是1，最大的“环”的长度则等于抽屉总数。</p><br><p><b>当每个人首先选择了自己编号的抽屉之后，沿着“环”的路径打开抽屉，最后一个未打开过抽屉里的卡片号码将会是一开始选择的抽屉的编号，也就是自己的编号</b>——因为这是个“环”嘛。</p><br><p>所以，回到原题，只要卡片的摆放没有形成长度超过50的“环”，那么所有人都可以找到自己的号码。</p><br><p>那么概率怎么算呢？</p><br><p>首先，最多只可能有一个长度超过50的“环”，将其长度记为L。于是，总共有C(100, L)种构成该“环”的组合，每一种组合有(L-1)!种排列（注意不是L!，因为这是“环”）。这个“环”之外的卡片有(100-L)!种排列，所以对于每一个L来说，都有C(100, L)·(L-1)!·(100-L)!=100!/L种情况。而100张卡片的总排列数是100!，所以最终所有人都猜对的可能性就是：</p><br><img src="http://pic4.zhimg.com/845995490596ad731a27b05c43f271f7_b.jpg" data-rawwidth="601" data-rawheight="52" class="origin_image zh-lightbox-thumb" width="601" data-original="http://pic4.zhimg.com/845995490596ad731a27b05c43f271f7_r.jpg"><br><p><b>≈ 0.31183</b><br></p><br>我们把这个值与0.0000000000000000000000000000008比较一下，是不是天壤之别？<br><br><p>最后，以TBBT里的一句话来结束这个回答：</p><br><img src="http://pic4.zhimg.com/e4ccbde14491df79460fc7248409805f_b.jpg" data-rawwidth="500" data-rawheight="711" class="origin_image zh-lightbox-thumb" width="500" data-original="http://pic4.zhimg.com/e4ccbde14491df79460fc7248409805f_r.jpg"><br><br>参考资料/想了解更多可点击：<a href="http://en.m.wikipedia.org/wiki/100_prisoners_problem" class=" wrap external" target="_blank" rel="nofollow noreferrer">100 prisoners problem<i class="icon-external"></i></a>



编辑于 2014-12-13



---
原问链接: [http://www.zhihu.com/question/27050108](http://www.zhihu.com/question/27050108)